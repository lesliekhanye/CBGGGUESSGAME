<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet" href="/style.css" />
    <script src="https://cdn.tailwindcss.com"></script>
    <link
      href="https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap"
      rel="stylesheet"
    />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Open+Sans:ital,wght@0,300..800;1,300..800&family=Press+Start+2P&display=swap"
      rel="stylesheet"
    />
    <title>CBGG</title>
  </head>

  <body class="splashWin bg-[#393939] pt-10">
    <h1 class="text-center text-xl">CENTRAL BANK GUESS GAME</h1>
    <div class="relative mt-5 w-36 h-36 mr-auto ml-auto">
      <div class="guessBox"></div>
      <p
        class="guessNumber absolute inset-0 flex justify-center items-center text-6xl"
      >
        ?
      </p>
    </div>

    <div class="difficulty flex justify-center mt-10">
      <div>
        <p class="text-center">Select Difficulty</p>
        <select
          name="difficultyLevel"
          id=""
          class="difficultyLevel h-10 bg-black text-sm"
        >
          <option value="Easy" selected class="text-xs">
            Easy Whistling Dixie
          </option>
          <option value="Medium" class="text-xs">
            Medium Whistling Helium
          </option>
          <option value="Hard" class="text-xs">Hard Whistling Mud</option>
          <option value="Impossible" class="text-xs">Impossible To Win</option>
        </select>
      </div>
    </div>

    <div class="gameRules mt-3">
      <p class="rule text-sm text-center font-serif">
        You 20 chances to guess a number between 0 and 21
      </p>
    </div>
    <div class="mainCont ml-auto mr-auto w-11/12 flex justify-center mt-5 p-3">
      <div
        class="flex justify-center grid-rows-4 grid grid-cols-3 gap-x-10 gap-y-3.5"
      >
        <div>
          <div id="guesses"><p>GUESSES LEFT</p></div>
          <div><p class="guesses text-center text-5xl">8</p></div>
        </div>

        <div class="flex justify-center items-center">
          <div class="p-3 bg-[#352C2C]">
            <div><p class="gamesPlay text-xs text-center">GAMES PLAYED</p></div>
            <div><p class="gamesPlayed text-sm text-center">0</p></div>
          </div>
        </div>
        <div>
          <div><p id="score">TOTAL SCORE</p></div>
          <div><p class="score text-center text-5xl mt-0 pt-0">0</p></div>
        </div>

        <div
          class="col-span-3 ml-auto mr-auto flex justify-center items-center"
        >
          <div>
            <span class="block text-center">Enter Your Guess</span>
            <input
              type="number"
              class="guessedNumber block h-12 text-black w-20 text-2xl text-center ml-auto mr-auto"
            />
          </div>
        </div>
        <div class="col-span-3 border-t-4 pt-2">
          <p class="hint text-center">READY TO PLAY</p>
        </div>
        <div class="col-span-3 flex justify-center items-center">
          <button class="play p-3 text-3xl text-gray-950 bg-[#D9D9D9]">
            Guess Number
          </button>
        </div>
      </div>
    </div>
    <script>
      const guessedNumber = document.querySelector(".guessedNumber");
      const buttonGuess = document.querySelector(".play");

      const guesses = document.querySelector(".guesses");
      const score = document.querySelector(".score");
      const gamesPlayed = document.querySelector(".gamesPlayed");
      const hint = document.querySelector(".hint");
      const difficultyDropdown = document.querySelector(".difficultyLevel");

      const rule = document.querySelector(".rule");

      let totalScore = 0;
      let games = 0;
      let guessesleft;
      let currentGuessNumber;

      // Function to initialize the game based on difficulty
      function initializeGame() {
        const difficultyLevel = difficultyDropdown.value;

        if (difficultyLevel === "Easy") {
          guessesleft = 20;
          currentGuessNumber = Math.floor(Math.random() * 21);
          rule.textContent =
            "You have 20 chances to guess a number between 0 and 21";
        } else if (difficultyLevel === "Medium") {
          guessesleft = 15;
          currentGuessNumber = Math.floor(Math.random() * 31); // Range 0-30
          rule.textContent =
            "You have 15 chances to guess a number between 0 and 31";
        } else if (difficultyLevel === "Hard") {
          guessesleft = 8;
          currentGuessNumber = Math.floor(Math.random() * 51); // Range 0-50
          rule.textContent =
            "You have 8 chances to guess a number between 0 and 51";
        } else if (difficultyLevel === "Impossible") {
          guessesleft = 2;
          currentGuessNumber = Math.floor(Math.random() * 101); // Range 0-100
          rule.textContent =
            "You have 2 chances to guess a number between 0 and 101";
        }

        guesses.textContent = guessesleft;
        hint.textContent = "READY TO PLAY";
        guessedNumber.value = ""; // Clear the input field
        buttonGuess.textContent = "GuessNumber"; // Reset the button text
        console.log(
          `Game started with difficulty: ${difficultyLevel}, Number: ${currentGuessNumber}`
        );

        // Ensure the button does not have multiple event listeners
        buttonGuess.removeEventListener("click", initializeGame); // Remove the "Play Again" listener if it exists
      }

      // Event listener for the button
      buttonGuess.addEventListener("click", function () {
        const userValue = parseInt(guessedNumber.value, 10);

        if (isNaN(userValue)) {
          hint.textContent = "Please enter a valid number!";
          return;
        }

        if (guessesleft > 0) {
          if (currentGuessNumber > userValue) {
            hint.textContent = "Go High";
            guessedNumber.value = "";
          } else if (currentGuessNumber < userValue) {
            hint.textContent = "Go Low";
            guessedNumber.value = "";
          } else {
            hint.textContent = "CORRECT! Ready for the next round.";
            const winSplash = document.querySelector(".splashWin");

            // Flash background green
            winSplash.classList.remove("bg-[#393939]");
            winSplash.classList.add("bg-[#00FF00]");

            // Revert background to the original color
            setTimeout(() => {
              winSplash.classList.remove("bg-[#00FF00]");
              winSplash.classList.add("bg-[#393939]");
            }, 500);

            console.log("Yay, you guessed it!");
            totalScore += guessesleft; // Add remaining guesses to score
            score.textContent = totalScore;
            games++;
            gamesPlayed.textContent = games;

            // Reset for the next round
            initializeGame();
            return;
          }

          guessesleft--; // Decrement guesses left
          guesses.textContent = guessesleft;

          if (guessesleft <= 0) {
            console.log("No guesses left. Game over.");
            hint.textContent = "You Lose, Try Again!";
            buttonGuess.textContent = "Play Again";

            // Add "Play Again" functionality
            buttonGuess.addEventListener("click", initializeGame);
          }
        }
      });

      // Initialize the game when the dropdown value changes
      difficultyDropdown.addEventListener("change", initializeGame);

      // Initialize the game on page load
      initializeGame();
    </script>
  </body>
</html>
